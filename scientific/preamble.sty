%---------------------------------------------------------------------------------------------------
% package loading: general
%---------------------------------------------------------------------------------------------------
\usepackage[T1]{fontenc}            % fontencoding
\usepackage[utf8]{inputenc}         % allows for utf-8 characters in the source tex
\usepackage{lmodern}                % sets lmoderm font
\usepackage{fancyhdr}               % fancy headers with lots of customization
\usepackage[table]{xcolor}          % colours
\usepackage{float}                  % adds several positions and support for latex floats
\usepackage{epigraph}               % adds an epigraph (quotation)
\usepackage{hhline}                 % adds double-lines for tables
\usepackage{cellspace}              % cell-vspace made easy
\usepackage{multirow}               % allow table cells to span multiple rows
\usepackage{minted}                 % fancy code highlighting
\usepackage[hidelinks]{hyperref}    % clickable links in the pdf and toc in viewer
\usepackage{longtable}

%---------------------------------------------------------------------------------------------------
% package loading: mathematics
%---------------------------------------------------------------------------------------------------
\usepackage{amsmath}                % commom mathematics package  
\usepackage{amssymb}                % commom math symbols
\usepackage{amsthm}                 % theme for ams math
\usepackage{amsfonts}               % fonts for ams
\usepackage{bm}                     % bold math (used for bold-faced greek letters)
\usepackage{cancel}                 % adds a 'strikethrough' in math-mode
\usepackage{esint}                  % beautiful integrals
\usepackage{mathtools}              % math expansion set
\usepackage{siunitx}                % adds neat methods of writing si-units and number formatting

%---------------------------------------------------------------------------------------------------
% package loading: graphics
%---------------------------------------------------------------------------------------------------
\usepackage{pgfplots}               % loads tikz as well, used for plots/graphics
\usepackage{graphicx}               % provides some useful tools for rotations, etc.
\usepackage[                        %
  straightvoltages                  % adds a lot of tikz-macros for drawing circuits
  ,nooldvoltagedirection]           %
           {circuitikz}             %
\usepackage{geometry}               % page layout control

%---------------------------------------------------------------------------------------------------
% package options: cellspace
%---------------------------------------------------------------------------------------------------
\setlength\cellspacetoplimit{4pt}        % sets space to cell-top    to  4 pts
\setlength\cellspacebottomlimit{4pt}     % sets space to cell-bottom to  4 pts

%---------------------------------------------------------------------------------------------------
% custom colors
%---------------------------------------------------------------------------------------------------
\definecolor{darkcyan}{RGB}{130, 234, 255}     % defines the colour darkcyan
\definecolor{purple}{RGB}{180, 2, 212}         % defines the colour purple
\definecolor{green}{RGB}{0, 153, 51}           % defines the colour green
\definecolor{red}{RGB}{204, 0, 0}              % defines the colour red
\definecolor{blue}{RGB}{0, 102, 255}           % defines the colour blue
\definecolor{orange}{RGB}{227, 102, 0}         % defines the colour orange

%---------------------------------------------------------------------------------------------------
% package options: geometry
%---------------------------------------------------------------------------------------------------
\geometry{
    a4paper,             % sets paper-size to a4
    twoside,             % sets the paper to be two-sided
    left=1.75cm,         % left page margin
    right=1.75cm,        % right page margin
    top=1.25cm,          % top page margin
    bottom=1.25cm,       % bottom page margin
    includeheadfoot      % include footer and header in margin calculations
}

%---------------------------------------------------------------------------------------------------
% package options: pgfplots and tikz
%---------------------------------------------------------------------------------------------------
\pgfplotsset{compat=1.16}           % sets compatibility level of pgfplots

\usepgfplotslibrary{                % select specific additional libraries for pgf
    patchplots,                     % allows for some crazy path manipulations
    fillbetween,                    % easily fill area between two curves
    groupplots                      % allows for multiple subplots in one tikzpicture
}

\usetikzlibrary{                    % select additional libraries for tikz
  calc,                             % adds simple calculation methods
  arrows.meta,                      % allows for fine-grained arrow stylization
  patterns,                         % adds some fill-patterns
  shapes.misc,                      % more shapes for \draw and nodes
  patterns.meta,                    % fine grained pattern control/definition
  decorations.pathmorphing,         % post-draw decorations,
  decorations.markings,             % set markings in a path
  matrix,                           % draw matrix like structures
  decorations,                      % path decorations (e.g. curly line with 'snake')
  external                          % compiles tikzpictures in a separate tex job
}

\newcommand{\tikzexternal}{tikz}
\tikzexternalize[prefix=\tikzexternal/]

%---------------------------------------------------------------------------------------------------
% set equation numbering and custom environments
%---------------------------------------------------------------------------------------------------
\newcommand{\theoremname}{Theorem}
\newcommand{\definitionname}{Definition}
\newcommand{\examplename}{Example}
\newcommand{\notename}{Note}

\newtheorem{definition}{\definitionname}[section]     % environment for definitions
\newtheorem{theorem}{\theoremname}[section]           % environment for theorems
\newtheorem{example}{\examplename}[section]           % environment for examples
\newtheorem{note}{\notename}[section]                 % environment for notes

%---------------------------------------------------------------------------------------------------
% misc
%---------------------------------------------------------------------------------------------------
\setlength{\parindent}{0pt}                           % sets indent after paragraph to 0pt
\newcommand*\col[2]{\textcolor{#1}{#2}}               % shorten textcolor command

%---------------------------------------------------------------------------------------------------
% flow components
%---------------------------------------------------------------------------------------------------
\tikzset{bcomp/.style={draw=blue,fill=blue!50,text=white}}
\tikzset{rcomp/.style={draw=red,fill=red!70,text=white}}
\tikzset{gcomp/.style={draw=green,fill=green!50,text=white}}
\tikzset{ocomp/.style={draw=orange,fill=orange!50,text=white}}
\tikzset{pcomp/.style={draw=purple,fill=purple!50,text=white}}
\tikzset{ycomp/.style={draw=yellow,fill=yellow!50,text=white}}

\tikzset{seqrdot/.style={red,circle,draw,minimum size=5pt,inner sep=0pt,fill=red!70}}
\tikzset{seqgdot/.style={green,circle,draw,minimum size=5pt,inner sep=0pt,fill=green!70}}
\tikzset{seqbdot/.style={blue,circle,draw,minimum size=5pt,inner sep=0pt,fill=blue!70}}
\tikzset{seqodot/.style={orange,circle,draw,minimum size=5pt, inner sep=0pt,fill=orange!70}}
\tikzset{seqpdot/.style={purple,circle,draw,minimum size=5pt, inner sep=0pt,fill=purple!70}}

\makeatletter
\pgfdeclareshape{oplus}
{
  \inheritsavedanchors[from=circle] 
  \inheritanchorborder[from=circle]
  \inheritanchor[from=circle]{north}
  \inheritanchor[from=circle]{north west}
  \inheritanchor[from=circle]{north east}
  \inheritanchor[from=circle]{center}
  \inheritanchor[from=circle]{west}
  \inheritanchor[from=circle]{east}
  \inheritanchor[from=circle]{mid}
  \inheritanchor[from=circle]{mid west}
  \inheritanchor[from=circle]{mid east}
  \inheritanchor[from=circle]{base}
  \inheritanchor[from=circle]{base west}
  \inheritanchor[from=circle]{base east}
  \inheritanchor[from=circle]{south}
  \inheritanchor[from=circle]{south west}
  \inheritanchor[from=circle]{south east}
  \inheritbackgroundpath[from=circle]
  \foregroundpath{
    \centerpoint%
    \pgf@xc=\pgf@x%
    \pgf@yc=\pgf@y%
    \pgfutil@tempdima=\radius%
    \pgfmathsetlength{\pgf@xb}{\pgfkeysvalueof{/pgf/outer xsep}}%  
    \pgfmathsetlength{\pgf@yb}{\pgfkeysvalueof{/pgf/outer ysep}}%  
    \ifdim\pgf@xb<\pgf@yb%
    \advance\pgfutil@tempdima by-\pgf@yb%
    \else%
    \advance\pgfutil@tempdima by-\pgf@xb%
    \fi%
    \pgfpathmoveto{\pgfpointadd{\pgfqpoint{\pgf@xc}{\pgf@yc}}{\pgfqpoint{\pgfutil@tempdima}{0pt}}}
    \pgfpathlineto{\pgfpointadd{\pgfqpoint{\pgf@xc}{\pgf@yc}}{\pgfqpoint{-\pgfutil@tempdima}{0pt}}}
    \pgfpathmoveto{\pgfpointadd{\pgfqpoint{\pgf@xc}{\pgf@yc}}{\pgfqpoint{0pt}{-\pgfutil@tempdima}}}
    \pgfpathlineto{\pgfpointadd{\pgfqpoint{\pgf@xc}{\pgf@yc}}{\pgfqpoint{0pt}{\pgfutil@tempdima}}}
    \pgfsetarrowsstart{}
    \pgfsetarrowsend{}
  }
}
\makeatother

\tikzset{add/.style={oplus,draw}}
\tikzset{mul/.style={oplus,draw,rotate=45}}

%---------------------------------------------------------------------------------------------------
% circuitkz options and components
%---------------------------------------------------------------------------------------------------
\tikzset{
  european voltages,
  res/.style={european resistor=$R_{#1}$},
  ind/.style={inductor=$L_{#1}$},
  cap/.style={capacitor=$C_{#1}$},
  cur/.style={european current source=$I_{#1}$},
  vol/.style={european voltage source=$U_{#1}$},
  ctrc/.style={european controlled current source=$#1$},
  ctrv/.style={european controlled voltage source=$#1$},
  gnd/.style={rground},
  imp/.style={generic=$\underline{Z}_{#1}$},
  adm/.style={generic=$\underline{Y}_{#1}$},
  v/.style={color=blue}
}

\ctikzset{
  bipole current style/.style={color=red},
  bipole voltage style/.style={color=blue}
}

%---------------------------------------------------------------------------------------------------
% minted options
%---------------------------------------------------------------------------------------------------
\setminted[matlab]{
  framesep=2mm,
  baselinestretch=1.2,
  fontsize=\footnotesize,
  bgcolor=blue!10,
  linenos
}

\newcommand{\algcapname}{Algorithm}